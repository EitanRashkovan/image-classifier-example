<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.0/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-KyZXEAg3QhqLMpG8r+8fhAXLRk2vvoC2f3B09zVXn8CA5QIVfZOJ3BCsw2P0p/We" crossorigin="anonymous">

    <title>Image Classifier</title>
  </head>
  <body>
    <h1>Signature Classifier</h1>
    <form name='photo_form2' id='photo_form2' method='GET' action="">
        <div class="input-group">
            <input type="file" class="form-control" id="inputGroupFile04" aria-describedby="inputGroupFileAddon04" aria-label="Upload">
            <button class="btn btn-outline-secondary" type="button" id="inputGroupFileAddon04" onclick="getCharacterInfo()">Submit</button>
        </div>
    </form>
    <!-- <form name="photo_form" id="photo_form" method="GET" action="", >
         <input type="file" name="fileupload" value="fileupload" id="fileupload">
          <label for="fileupload"> Select a file to upload</label> 
          <input type="button" id="submit_button" value="submit button" onclick="getCharacterInfo()"> 
        </form> -->

    <div id='test_image'>
        <p>No files selected</p>
    </div>
    <div id='char_info'>
        <p>No character selected</p>
    </div>

    <script type="text/javascript">
        var httpRequest =new XMLHttpRequest();

        function testFunction() {

            var form = document.getElementById('photo_form2')
            var fileObj = form.inputGroupFile04.files[0];
            const objectURL = URL.createObjectURL(fileObj);
            var template = `
            <img src=${objectURL}>
            `
            document.getElementById("test_image").innerHTML = template;
            document.getElementById('char_info').innerHTML = httpRequest.response
        }

        function getCharacterInfo() {
            var characterIndex = Math.floor(Math.random() * 50);

            if (!httpRequest) {
                alert('Giving up :( Cannot create an XMLHTTP instance');
                return false;
            }
            httpRequest.onreadystatechange = testFunction;
            httpRequest.open('GET', 'https://swapi.dev/api/people/' + characterIndex);
            httpRequest.send();
            }
// var httpRequest =new XMLHttpRequest();  // global variable, not good practice
// document.getElementById("numberselecto").addEventListener('click', getCharacterInfo);
//             function responseHandler() {
//                 console.log(httpRequest.responseText);
//                 if (httpRequest.readyState === XMLHttpRequest.DONE) {
//                     if (httpRequest.status === 200) {
//                         var response = JSON.parse(httpRequest.response)
//                         var template = `
//                         <p>
//                         Hello my name is ${response.name}. I was born in the year ${response.birth_year} and have ${response.skin_color} skin. 
//                         </p>
//                         `
//                         document.getElementById("bio").innerHTML = template;
//                         document.getElementById("raw_response").innerHTML = httpRequest.response
//                     } else {
                        
//                     }
//                 }
//             }

            // function getCharacterInfo(index) {
            //     var characterIndex = document.getElementById("numberselector").value;

            //     if (!httpRequest) {
            //         alert('Giving up :( Cannot create an XMLHTTP instance');
            //         return false;
            //     }

            //     httpRequest.onreadystatechange = responseHandler;
            //     httpRequest.open('GET', 'https://swapi.dev/api/people/' + characterIndex);
            //     httpRequest.send();
            // }
//     </script>
//     <!-- Optional JavaScript; choose one of the two! -->

//     <!-- Option 1: Bootstrap Bundle with Popper -->
//     <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.0/dist/js/bootstrap.bundle.min.js" integrity="sha384-U1DAWAznBHeqEIlVSCgzq+c9gqGAJn5c/t99JyeKa9xxaYpSvHU5awsuZVVFIhvj" crossorigin="anonymous"></script>

//     <!-- Option 2: Separate Popper and Bootstrap JS -->
//     <!--
//     <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.3/dist/umd/popper.min.js" integrity="sha384-eMNCOe7tC1doHpGoWe/6oMVemdAVTMs2xqW4mwXrXsW0L84Iytr2wi5v2QjrP/xp" crossorigin="anonymous"></script>
//     <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.0/dist/js/bootstrap.min.js" integrity="sha384-cn7l7gDp0eyniUwwAZgrzD06kc/tftFf19TOAs2zVinnD/C7E91j9yyk5//jjpt/" crossorigin="anonymous"></script>
//     -->
//   </body>
// </html>