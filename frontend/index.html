<!DOCTYPE html>
<html lang="en">

<head>
  <title>Image Classifier</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
  
  <style>
    /* Remove the navbar's default margin-bottom and rounded borders */
    .navbar {
      margin-bottom: 0;
      border-radius: 0;
    }

    /* Add a gray background color and some padding to the footer */
    footer {
      background-color: #f2f2f2;
      padding: 25px;
    }

    /* Center the column */
    .col-centered {
      float: none;
      margin: 0 auto;
    }
  </style>
</head>

<body>

  <nav class="navbar navbar-inverse">
    <div class="container-fluid">
      <div class="navbar-header">
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#myNavbar">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="https://github.com/JasonFreeberg/image-classifier-example">GitHub Repo</a>
      </div>
      <div class="collapse navbar-collapse" id="myNavbar">
        <ul class="nav navbar-nav">
          <li class="active"><a href="#">Home</a></li>
          <li><a href="#">About</a></li>
        </ul>
      </div>
    </div>
  </nav>

  <div class="jumbotron">
    <div class="container text-center">
      <h1 style="font-family:papyrus;">Image Classifier</h1>
      <p>utilize a machine learning model to predict whether an uploaded signature is forged vs real</p>
    </div>
  </div>

  <div class="container-fluid bg-3 text-center">
    <div class="row">
      <div class="col-xs-12">
        <h3>Upload any signature from your computer by clicking the Choose File button followed by the Submit button
        </h3><br>
      </div>

      <div class="col-xs-4 col-xs-offset-4">
        <form name='photo_form2' id='photo_form2' method='GET' action="">
            <input type="file" class="form-control" id="inputGroupFile04" aria-describedby="inputGroupFileAddon04"
              aria-label="Upload">
            <button class="btn btn-outline-secondary" type="button" id="inputGroupFileAddon04"
              onclick="sendPostRequest()">Submit</button>
        </form>
      </div>

      <div class="col-xs-6 col-xs-offset-3">
        <div id='test_image'>
          <p>No files selected</p>
        </div>
      </div>
    </div>
    <div id='char_info'>
      <p>No character selected</p>
    </div>



    <script type="text/javascript">
      var httpRequest = new XMLHttpRequest();

      function getResponse() {

        var form = document.getElementById('photo_form2');
        var fileObj = form.inputGroupFile04.files[0];
        const objectURL = URL.createObjectURL(fileObj);
        var template = `
            <img src=${objectURL}>
            `
        document.getElementById("test_image").innerHTML = template;
        document.getElementById('char_info').innerHTML = httpRequest.response;
      }

      function sendPostRequest() {
        let formData = new FormData();
        var form = document.getElementById('photo_form2');
        var file = form.inputGroupFile04.files[0];
        formData.append('file', file);
        console.log(formData.get('file'))

        if (!httpRequest) {
          alert('Giving up :( Cannot create an XMLHTTP instance');
          return false;
        }
        httpRequest.onreadystatechange = getResponse;
        httpRequest.open('POST', 'http://127.0.0.1:5000/image-upload');
        httpRequest.setRequestHeader('Content-Type', 'multipart/form-data');
        httpRequest.send(formData);
      }
    </script>

    <footer class="container-fluid text-center">
      <p>Found something to add? help contribute to the <a
          href="https://github.com/JasonFreeberg/image-classifier-example">GitHub repo!</a></p>
    </footer>

</body>

</html>
